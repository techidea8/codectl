{{define "./server/app/[prjname]/logic/init.go.tpl"}}
package logic

import (
	"os"
	"github.com/techidea8/codectl/app/{{.Project.Name|lower}}/conf"
	"github.com/techidea8/codectl/app/{{.Project.Name|lower}}/model"
	"github.com/techidea8/codectl/infra/dbkit"
	"github.com/techidea8/codectl/infra/logger"
)

func InitApp(c *conf.AppConf) {
	engin, err := dbkit.OpenDb(dbkit.DBTYPE(c.DbType), c.Dsn, dbkit.WithWriter(os.Stdout), dbkit.AutoMigrate(),
	dbkit.SetLogLevel(logger.LogLevel(c.LogLevel)),
	)
	if err != nil {
		panic(err)
	}
	DbEngin = engin
}

{{end}}